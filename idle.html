<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- Favicon for different browsers and devices -->
        <link rel="icon" type="image/svg+xml" href="favicon.svg" />
        <link rel="icon" type="image/png" sizes="32x32" href="favicon.svg" />
        <link rel="icon" type="image/png" sizes="16x16" href="favicon.svg" />
        <link rel="apple-touch-icon" sizes="180x180" href="favicon.svg" />
        <link rel="shortcut icon" href="favicon.svg" />

        <title>Idle Goose Game</title>
        <!-- Open Graph Meta Tags for Idle Goose Game -->
        <meta property="og:title" content="Idle Goose Game by AppleGeese!" />
        <meta
            property="og:description"
            content="Click the goose, gather apples, and upgrade your way to ultimate goose power in this idle clicker game!"
        />
        <!-- Removed og:image for now -->
        <meta property="og:url" content="https://applegeese.com/idle.html" />
        <meta property="og:type" content="game" />

        <!-- Font Awesome for icons -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <style>
            /* Reset */
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            /* Global Body Styles */
            body {
                font-family: "Arial", sans-serif;
                background: linear-gradient(135deg, #87ceeb 0%, #98fb98 100%);
                min-height: 100vh;
                padding: 20px;
                color: #333;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            /* Dark Mode Styles */
            @media (prefers-color-scheme: dark) {
                body {
                    background: linear-gradient(
                        135deg,
                        #1a1a2e 0%,
                        #16213e 100%
                    );
                    color: #e4e4e7;
                }

                .game-container {
                    background: rgba(30, 30, 30, 0.9);
                    border: 1px solid #374151;
                }

                .panel {
                    background: rgba(30, 30, 30, 0.9);
                    border: 1px solid #374151;
                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
                }

                .stat-card .tooltip {
                    background-color: rgba(55, 65, 81, 0.95);
                    color: #e4e4e7;
                    border: 1px solid #4b5563;
                }

                .stat-card .tooltip::after {
                    border-top-color: rgba(55, 65, 81, 0.95);
                }

                .stat-card {
                    background: linear-gradient(
                        135deg,
                        #374151 0%,
                        #4b5563 100%
                    );
                    border-color: #6b7280;
                    color: #f1f5f9;
                }

                .stat-value {
                    color: #f1f5f9;
                }

                .stat-label {
                    color: #d1d5db;
                }

                h1 {
                    color: #f1f5f9;
                    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
                }

                .goose-area p {
                    color: #e4e4e7; /* Brighter text color for dark mode */
                }

                .tab-container {
                    background: rgba(30, 30, 30, 0.9);
                    border: 1px solid #374151;
                }

                .tabs {
                    background: #374151;
                    border-bottom-color: #4b5563;
                }

                .tab-button {
                    color: #d1d5db;
                }

                .tab-button:hover {
                    background: rgba(59, 130, 246, 0.1);
                    color: #60a5fa;
                }

                .tab-button.active {
                    background: #4b5563;
                    color: #60a5fa;
                    border-bottom-color: #60a5fa;
                }

                .tab-content {
                    background: rgba(30, 30, 30, 0.9);
                }

                .upgrade {
                    background: linear-gradient(
                        135deg,
                        #374151 0%,
                        #4b5563 100%
                    );
                    border-color: #6b7280;
                }

                .upgrade:hover {
                    border-color: #60a5fa;
                }

                .upgrade-name {
                    color: #f1f5f9;
                }

                .upgrade-description {
                    color: #d1d5db;
                }

                .upgrade-count {
                    background: #60a5fa;
                    color: #1e293b;
                }

                .upgrade-button {
                    background: #059669;
                }

                .upgrade-button:hover {
                    background: #047857;
                }

                .upgrade-button:disabled {
                    background: #6b7280;
                }

                .upgrade-cost {
                    color: #d1d5db;
                }

                .achievement {
                    background: #451a03;
                    border-left-color: #f59e0b;
                    color: #fbbf24;
                }

                .achievement.unlocked {
                    background: #064e3b;
                    border-left-color: #10b981;
                    color: #34d399;
                }

                .prestige-section h3 {
                    color: #f1f5f9; /* Bright for dark mode */
                }

                .prestige-section p {
                    color: #d1d5db; /* Lighter for dark mode */
                }

                .prestige-button {
                    background: transparent;
                    color: #e4e4e7; /* Brighter color for dark mode */
                    border: 1px solid #6b7280; /* Slightly lighter border */
                    box-shadow: none;
                }

                .prestige-button:hover {
                    background: rgba(59, 130, 246, 0.1);
                    border-color: #60a5fa; /* Brighter hover border */
                    color: #60a5fa; /* Brighter hover text */
                }

                .prestige-button:disabled {
                    background: rgba(
                        75,
                        85,
                        99,
                        0.2
                    ); /* Softer disabled background */
                    border-color: #4b5563; /* Softer disabled border */
                    color: #9ca3af; /* Softer disabled text */
                    cursor: not-allowed;
                }

                .mobile-menu-toggle {
                    background: #60a5fa;
                }

                .mobile-menu-toggle:hover {
                    background: #3b82f6;
                }

                @media (max-width: 768px) {
                    .sidebar.mobile-open {
                        background: rgba(30, 30, 30, 0.98);
                        border-color: #374151;
                    }
                }
            }

            /* Game Container */
            .game-container {
                width: 85%; /* Set to 85% of the viewport width */
                max-width: 1800px; /* Maximum width to prevent it from getting too large */
                min-height: 800px;
                margin: 0 auto;
                background: rgba(255, 255, 255, 0.9);
                border-radius: 15px;
                padding: 30px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            /* Main Game Area Layout */
            .main-area {
                display: flex;
                gap: 30px;
                align-items: flex-start;
            }

            .game-content {
                flex: 1;
            }

            .sidebar {
                width: 400px;
                flex-shrink: 0;
            }

            /* General Panel Styling */
            .panel {
                background: rgba(255, 255, 255, 0.9);
                border-radius: 15px;
                padding: 15px;
                box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            }

            /* Heading */
            h1 {
                text-align: center;
                color: #2c3e50;
                margin-bottom: 20px;
                font-size: 2.5em;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            }

            /* Stats Display */
            .stats {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                margin-bottom: 30px;
            }

            .stat-card {
                background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
                padding: 15px;
                border-radius: 10px;
                border: 2px solid #e9ecef;
                text-align: center;
                position: relative;
            }

            .stat-card .tooltip {
                position: absolute;
                bottom: 100%;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0, 0, 0, 0.9);
                color: white;
                padding: 8px 12px;
                border-radius: 6px;
                font-size: 0.9em;
                white-space: nowrap;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                z-index: 1000;
                pointer-events: none;
            }

            .stat-card .tooltip::after {
                content: "";
                position: absolute;
                top: 100%;
                left: 50%;
                transform: translateX(-50%);
                border: 5px solid transparent;
                border-top-color: rgba(0, 0, 0, 0.9);
            }

            .stat-card:hover .tooltip {
                opacity: 1;
                visibility: visible;
            }

            .stat-value {
                font-size: 1.5em;
                font-weight: bold;
                color: #2c3e50;
            }

            .stat-label {
                color: #6c757d;
                font-size: 0.9em;
                margin-top: 5px;
            }

            /* Goose Area */
            .goose-area {
                text-align: center;
                margin: 30px auto;
                width: 100%;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            .goose-area p {
                color: #34495e; /* Default light mode text color */
                font-size: 1.1em;
                margin-top: 10px;
            }

            .main-goose {
                font-size: 12em;
                cursor: pointer;
                transition: transform 0.1s;
                user-select: none;
                display: inline-block;
                animation: float 3s ease-in-out infinite;
            }

            .main-goose:hover {
                transform: scale(1.1);
            }

            .main-goose:active {
                transform: scale(0.95);
            }

            @keyframes float {
                0%,
                100% {
                    transform: translateY(0px);
                }
                50% {
                    transform: translateY(-10px);
                }
            }

            @keyframes shake {
                0% {
                    transform: translateX(0px) translateY(0px) rotate(0deg)
                        scale(1);
                }
                10% {
                    transform: translateX(-15px) translateY(-8px) rotate(-5deg)
                        scale(1.05);
                }
                20% {
                    transform: translateX(15px) translateY(-12px) rotate(5deg)
                        scale(1.1);
                }
                30% {
                    transform: translateX(-12px) translateY(-6px) rotate(-3deg)
                        scale(1.08);
                }
                40% {
                    transform: translateX(12px) translateY(-10px) rotate(3deg)
                        scale(1.06);
                }
                50% {
                    transform: translateX(-8px) translateY(-4px) rotate(-2deg)
                        scale(1.04);
                }
                60% {
                    transform: translateX(8px) translateY(-6px) rotate(2deg)
                        scale(1.02);
                }
                70% {
                    transform: translateX(-5px) translateY(-2px) rotate(-1deg)
                        scale(1.01);
                }
                80% {
                    transform: translateX(5px) translateY(-3px) rotate(1deg)
                        scale(1.005);
                }
                90% {
                    transform: translateX(-2px) translateY(-1px) rotate(-0.5deg)
                        scale(1.002);
                }
                100% {
                    transform: translateX(0px) translateY(0px) rotate(0deg)
                        scale(1);
                }
            }

            .main-goose.shake {
                animation: shake 0.6s ease-in-out infinite;
            }

            /* Click Effects */
            .click-effect {
                position: absolute;
                color: #28a745;
                font-weight: bold;
                font-size: 1.2em;
                pointer-events: none;
                animation: floatUp 1s ease-out forwards;
            }

            @keyframes floatUp {
                0% {
                    opacity: 1;
                    transform: translateY(0px);
                }
                100% {
                    opacity: 0;
                    transform: translateY(-50px);
                }
            }

            /* Tab Navigation */
            .tab-container {
                background: rgba(255, 255, 255, 0.8);
                border-radius: 10px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
                overflow: hidden;
                border: 2px solid #e9ecef;
            }

            .tabs {
                display: flex;
                background: #f8f9fa;
                border-bottom: 2px solid #e9ecef;
            }

            .tab-button {
                flex: 1;
                padding: 10px 12px;
                background: none;
                border: none;
                cursor: pointer;
                font-weight: bold;
                color: #6c757d;
                transition: all 0.3s;
                font-size: 0.9em;
            }

            .tab-button:hover {
                background: rgba(0, 123, 255, 0.1);
                color: #007bff;
            }

            .tab-button.active {
                background: white;
                color: #007bff;
                border-bottom: 3px solid #007bff;
            }

            .tab-content {
                padding: 15px;
                display: none;
                max-height: 400px;
                overflow-y: auto;
            }

            .tab-content.active {
                display: block;
            }

            /* Upgrades */
            .upgrades {
                display: grid;
                gap: 10px;
            }

            .upgrade {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 10px;
                background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
                border-radius: 8px;
                border: 2px solid #e9ecef;
                transition: all 0.3s;
            }

            .upgrade:hover {
                border-color: #007bff;
                transform: translateY(-2px);
            }

            .upgrade-info {
                flex: 1;
            }

            .upgrade-name {
                font-weight: bold;
                color: #2c3e50;
            }

            .upgrade-description {
                font-size: 0.8em;
                color: #6c757d;
            }

            .upgrade-count {
                background: #007bff;
                color: white;
                border-radius: 50%;
                width: 25px;
                height: 25px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.8em;
                margin-right: 10px;
            }

            .upgrade-buttons {
                display: flex;
                flex-direction: column;
                gap: 4px;
                align-items: flex-end;
            }

            .buy-quantity-row {
                display: flex;
                gap: 3px;
            }

            .upgrade-button {
                background: #28a745;
                color: white;
                border: none;
                padding: 4px 8px;
                border-radius: 4px;
                cursor: pointer;
                font-weight: bold;
                transition: background 0.3s;
                font-size: 0.8em;
                min-width: 35px;
            }

            .upgrade-button:hover {
                background: #218838;
            }

            .upgrade-button:disabled {
                background: #6c757d;
                cursor: not-allowed;
            }

            .upgrade-button.max {
                background: #dc3545;
            }

            .upgrade-button.max:hover {
                background: #c82333;
            }

            .upgrade-cost {
                font-size: 0.75em;
                color: #6c757d;
                text-align: right;
                margin-top: 2px;
            }

            /* Achievements */
            .achievements {
                max-height: 200px;
                overflow-y: auto;
            }

            .achievement {
                padding: 8px;
                margin: 5px 0;
                background: #fff3cd;
                border-radius: 5px;
                border-left: 4px solid #ffc107;
                font-size: 0.9em;
            }

            .achievement.unlocked {
                background: #d4edda;
                border-left-color: #28a745;
            }

            /* Prestige Section */
            .prestige-section {
                text-align: center;
                margin-top: 20px;
            }

            .prestige-section h3 {
                color: #2c3e50; /* Default light mode text color */
            }

            .prestige-section p {
                color: #34495e; /* Default light mode text color */
            }

            .prestige-button {
                background: transparent;
                color: #34495e; /* Darker, more readable text for light mode */
                border: 2px solid #aebac7; /* Softer border for light mode */
                padding: 10px 20px;
                border-radius: 8px;
                font-size: 1em;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                box-shadow: none;
            }

            .prestige-button:hover {
                background: rgba(0, 123, 255, 0.1);
                border-color: #007bff;
                color: #007bff;
            }

            .prestige-button:disabled {
                background: rgba(108, 117, 125, 0.1);
                border-color: #6c757d;
                color: #6c757d;
                cursor: not-allowed;
            }

            /* Mobile Controls */
            .mobile-menu-toggle {
                display: none;
                background: #007bff;
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 8px;
                font-weight: bold;
                cursor: pointer;
                width: 100%;
                margin-bottom: 15px;
            }

            .mobile-menu-toggle:hover {
                background: #0056b3;
            }

            .mobile-stats {
                display: none;
                grid-template-columns: 1fr 1fr;
                gap: 15px;
                margin-bottom: 20px;
            }

            /* Decorative Apples */
            .decorative-apples {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                pointer-events: none;
                z-index: -1;
                overflow: hidden;
            }

            .apple {
                position: absolute;
                font-size: 3em;
                opacity: 0.7;
                animation: fall linear infinite;
                user-select: none;
            }

            .apple:nth-child(odd) {
                animation-delay: -2s;
            }

            .apple:nth-child(3n) {
                animation-delay: -4s;
            }

            .apple:nth-child(4n) {
                animation-delay: -6s;
            }

            @keyframes fall {
                0% {
                    transform: translateY(-100px);
                    opacity: 0;
                }
                10% {
                    opacity: 0.7;
                }
                90% {
                    opacity: 0.7;
                }
                100% {
                    transform: translateY(calc(100vh + 100px));
                    opacity: 0;
                }
            }

            /* Responsive Design */
            @media (max-width: 768px) {
                .stats {
                    display: none;
                }

                .mobile-stats {
                    display: grid;
                }

                .mobile-menu-toggle {
                    display: block;
                }

                .sidebar.mobile-open #mobileMenuClose {
                    display: block !important;
                }

                .main-area {
                    flex-direction: column;
                }

                .game-content {
                    width: 100%;
                    text-align: center;
                }

                .sidebar {
                    width: 100%;
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(255, 255, 255, 0.98);
                    z-index: 1000;
                    display: none;
                    overflow-y: auto;
                    padding: 20px;
                }

                .sidebar.mobile-open {
                    display: block;
                }

                .goose-area {
                    margin: 20px auto;
                    text-align: center;
                    width: 100%;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                }

                .goose-area p {
                    color: #e4e4e7; /* Brighter text color for dark mode */
                }

                .main-goose {
                    font-size: 10em;
                }

                .tab-container {
                    display: block;
                }
            }
        </style>
    </head>
    <body>
        <div class="decorative-apples" id="decorativeApples"></div>
        <div class="game-container">
            <h1>ü™ø Idle Goose Game ü™ø</h1>

            <!-- Desktop Stats Display -->
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-value" id="apples">0</div>
                    <div class="stat-label">Apples</div>
                    <div class="tooltip" id="applesFullNumber">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="applesPerSecond">0</div>
                    <div class="stat-label">Per Second</div>
                    <div class="tooltip" id="applesPerSecondFullNumber">0</div>
                </div>
            </div>

            <!-- Mobile Stats Display (conditionally shown on small screens) -->
            <div class="mobile-stats">
                <div class="stat-card">
                    <div class="stat-value" id="mobileApples">0</div>
                    <div class="stat-label">Apples</div>
                    <div class="tooltip" id="mobileApplesFullNumber">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="mobileApplesPerSecond">0</div>
                    <div class="stat-label">Per Second</div>
                    <div class="tooltip" id="mobileApplesPerSecondFullNumber">
                        0
                    </div>
                </div>
            </div>

            <div class="main-area">
                <div class="game-content">
                    <button class="mobile-menu-toggle" id="mobileMenuToggle">
                        üì± Show Menu
                    </button>
                    <div class="goose-area">
                        <div class="main-goose" id="mainGoose">ü™ø</div>
                        <p>Click the goose to gather apples!</p>
                    </div>
                </div>

                <div class="sidebar">
                    <button
                        class="mobile-menu-toggle"
                        id="mobileMenuClose"
                        style="display: none"
                    >
                        ‚ùå Close Menu
                    </button>
                    <div class="tab-container">
                        <div class="tabs">
                            <button class="tab-button active" id="upgradesTab">
                                üè™ Passive
                            </button>
                            <button class="tab-button" id="clickTab">
                                üëÜ Click
                            </button>
                            <button class="tab-button" id="autoTab">
                                ü§ñ Auto
                            </button>
                            <button class="tab-button" id="achievementsTab">
                                üèÜ Achievements
                            </button>
                            <button class="tab-button" id="prestigeTab">
                                ‚ú® Prestige
                            </button>
                        </div>

                        <!-- Tab Content Areas -->
                        <div class="tab-content active" id="upgradesContent">
                            <div class="upgrades" id="upgrades"></div>
                        </div>

                        <div class="tab-content" id="clickContent">
                            <div class="upgrades" id="clickUpgrades"></div>
                        </div>

                        <div class="tab-content" id="autoContent">
                            <div class="upgrades" id="autoUpgrades"></div>
                        </div>

                        <div class="tab-content" id="achievementsContent">
                            <div class="achievements" id="achievements"></div>
                        </div>

                        <div class="tab-content" id="prestigeContent">
                            <div
                                class="prestige-section panel"
                                style="margin-top: 0"
                            >
                                <h3 style="color: #2c3e50">
                                    Prestige Points:
                                    <span id="prestigePoints">0</span>
                                </h3>
                                <p style="color: #34495e">
                                    Accumulate enough apples to reset your
                                    progress and gain Prestige Points, which
                                    provide a permanent multiplier to your apple
                                    production.
                                </p>
                                <button
                                    class="prestige-button"
                                    id="prestigeButton"
                                >
                                    Prestige! (Requires
                                    <span id="prestigeCost">1,000,000</span>
                                    Apples)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            class IdleGooseGame {
                constructor() {
                    this.gameState = {
                        apples: 0,
                        totalApples: 0,
                        applesPerSecond: 0,
                        clickPower: 1,
                        totalClicks: 0,
                        prestigePoints: 0,
                        prestigeMultiplier: 1,
                        upgrades: {},
                        achievements: new Set(),
                        buyQuantity: 1,
                        lastSaveTime: Date.now(),
                        autoClicksPerSecond: 0,
                    };
                    IdleGooseGame.PRESTIGE_COST = 1000000;

                    this.clickTimes = [];
                    this.dynamicClicksPerSecond = 0;
                    this.shakeTimeout = null;
                    this.autoClickInterval = null;

                    // UI elements for prestige
                    this.prestigePointsElement =
                        document.getElementById("prestigePoints");
                    this.prestigeCostElement =
                        document.getElementById("prestigeCost");
                    this.prestigeButton =
                        document.getElementById("prestigeButton");

                    this.upgrades = [
                        {
                            id: "helper_duck",
                            name: "ü™ø Helper Goose",
                            description: "+0.1 apples/sec",
                            baseCost: 10,
                            bpsIncrease: 0.1,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "pond",
                            name: "üèûÔ∏è Pond",
                            description: "+0.5 apples/sec",
                            baseCost: 100,
                            bpsIncrease: 0.5,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "duck_family",
                            name: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Goose Family",
                            description: "+2 apples/sec",
                            baseCost: 500,
                            bpsIncrease: 2,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "bread_factory",
                            name: "üè≠ Apple Orchard",
                            description: "+8 apples/sec",
                            baseCost: 2000,
                            bpsIncrease: 8,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "goose_army",
                            name: "ü™øü™øü™ø Goose Army",
                            description: "+20 apples/sec",
                            baseCost: 10000,
                            bpsIncrease: 20,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "golden_goose",
                            name: "‚ú® Golden Goose",
                            description: "+50 apples/sec",
                            baseCost: 50000,
                            bpsIncrease: 50,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "mutant_apple_tree",
                            name: "üçè Mutant Apple Tree",
                            description: "+150 apples/sec",
                            baseCost: 200000,
                            bpsIncrease: 150,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "disco_goose",
                            name: "ü™© Disco Goose",
                            description: "+500 apples/sec",
                            baseCost: 1000000,
                            bpsIncrease: 500,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "scientist_goose",
                            name: "üß™ Scientist Goose",
                            description: "+2,000 apples/sec",
                            baseCost: 5000000,
                            bpsIncrease: 2000,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "apple_cloning_lab",
                            name: "üß¨ Apple Cloning Lab",
                            description: "+10,000 apples/sec",
                            baseCost: 25000000,
                            bpsIncrease: 10000,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "celestial_orchard",
                            name: "‚òÄÔ∏è Celestial Orchard",
                            description: "+50,000 apples/sec",
                            baseCost: 150000000,
                            bpsIncrease: 50000,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "divine_goose",
                            name: "ü™Ω Divine Goose",
                            description: "+250,000 apples/sec",
                            baseCost: 1000000000,
                            bpsIncrease: 250000,
                            costMultiplier: 1.15,
                            type: "passive",
                        },
                        {
                            id: "sharp_beak",
                            name: "üó°Ô∏è Sharp Beak",
                            description: "+1 apple per click",
                            baseCost: 25,
                            clickIncrease: 1,
                            costMultiplier: 1.2,
                            type: "click",
                        },
                        {
                            id: "strong_wings",
                            name: "üí™ Strong Wings",
                            description: "+3 apples per click",
                            baseCost: 150,
                            clickIncrease: 3,
                            costMultiplier: 1.2,
                            type: "click",
                        },
                        {
                            id: "golden_feathers",
                            name: "‚ú® Golden Feathers",
                            description: "+10 apples per click",
                            baseCost: 750,
                            clickIncrease: 10,
                            costMultiplier: 1.2,
                            type: "click",
                        },
                        {
                            id: "magic_touch",
                            name: "ü™Ñ Magic Touch",
                            description: "+25 apples per click",
                            baseCost: 3000,
                            clickIncrease: 25,
                            costMultiplier: 1.2,
                            type: "click",
                        },
                        {
                            id: "apple_magnet",
                            name: "üß≤ Apple Magnet",
                            description: "+75 apples per click",
                            baseCost: 15000,
                            clickIncrease: 75,
                            costMultiplier: 1.2,
                            type: "click",
                        },
                        {
                            id: "auto_pecker",
                            name: "ü§ñ Auto Pecker",
                            description: "0.1 clicks per second",
                            baseCost: 100,
                            autoClickIncrease: 0.1,
                            costMultiplier: 1.3,
                            type: "auto",
                        },
                        {
                            id: "click_bot",
                            name: "ü¶æ Click Bot",
                            description: "0.5 clicks per second",
                            baseCost: 1000,
                            autoClickIncrease: 0.5,
                            costMultiplier: 1.3,
                            type: "auto",
                        },
                        {
                            id: "robo_goose",
                            name: "ü§ñ Robo Goose",
                            description: "2 clicks per second",
                            baseCost: 10000,
                            autoClickIncrease: 2,
                            costMultiplier: 1.3,
                            type: "auto",
                        },
                        {
                            id: "quantum_clicker",
                            name: "‚öõÔ∏è Quantum Clicker",
                            description: "10 clicks per second",
                            baseCost: 100000,
                            autoClickIncrease: 10,
                            costMultiplier: 1.3,
                            type: "auto",
                        },
                    ];

                    this.achievements = [
                        {
                            id: "first_click",
                            name: "First Steps",
                            description: "Click the goose for the first time",
                            condition: () => this.gameState.totalClicks >= 1,
                        },
                        {
                            id: "hundred_clicks",
                            name: "Clicking Champion",
                            description: "Click the goose 100 times",
                            condition: () => this.gameState.totalClicks >= 100,
                        },
                        {
                            id: "first_upgrade",
                            name: "Getting Help",
                            description: "Buy your first upgrade",
                            condition: () =>
                                Object.values(this.gameState.upgrades).some(
                                    (count) => count > 0,
                                ),
                        },
                        {
                            id: "thousand_apples",
                            name: "Apple Collector",
                            description: "Collect 1,000 apples",
                            condition: () => this.gameState.totalApples >= 1000,
                        },
                        {
                            id: "ten_aps",
                            name: "Passive Income",
                            description: "Reach 10 apples per second",
                            condition: () =>
                                this.gameState.applesPerSecond >= 10,
                        },
                        {
                            id: "first_prestige",
                            name: "New Beginnings",
                            description: "Prestige for the first time",
                            condition: () => this.gameState.prestigePoints >= 1,
                        },
                        {
                            id: "million_apples",
                            name: "Millionaire",
                            description: "Collect 1,000,000 total apples",
                            condition: () =>
                                this.gameState.totalApples >= 1000000,
                        },
                        {
                            id: "apple_tycoon",
                            name: "Apple Tycoon",
                            description: "Collect 1,000,000,000 total apples",
                            condition: () =>
                                this.gameState.totalApples >= 1000000000,
                        },
                        {
                            id: "passive_powerhouse",
                            name: "Passive Powerhouse",
                            description: "Reach 1,000 apples per second",
                            condition: () =>
                                this.gameState.applesPerSecond >= 1000,
                        },
                        {
                            id: "prestige_master",
                            name: "Prestige Master",
                            description: "Achieve 5 Prestige Points",
                            condition: () => this.gameState.prestigePoints >= 5,
                        },
                        {
                            id: "obsessive_clicker",
                            name: "Obsessive Clicker",
                            description: "Click the goose 10,000 times",
                            condition: () =>
                                this.gameState.totalClicks >= 10000,
                        },
                        {
                            id: "upgrade_enthusiast",
                            name: "Upgrade Enthusiast",
                            description:
                                "Own at least one of every upgrade type",
                            condition: () =>
                                this.upgrades.every(
                                    (upgrade) =>
                                        (this.gameState.upgrades[upgrade.id] ||
                                            0) > 0,
                                ),
                        },
                    ];

                    this.init();
                }

                init() {
                    this.loadGame();
                    this.calculateOfflineProgress();
                    this.setupEventListeners();
                    this.setupTabs();
                    this.createUpgradeElements();
                    this.createAchievementElements();
                    this.calculateClickPower();
                    this.calculateAutoClicksPerSecond();
                    this.createDecorativeApples();
                    this.updateDisplay();
                    this.startGameLoop();
                    this.startAutoClicker();
                }

                setupEventListeners() {
                    document
                        .getElementById("mainGoose")
                        .addEventListener("click", (e) => this.clickGoose(e));

                    // Mobile menu toggle
                    const mobileToggle =
                        document.getElementById("mobileMenuToggle");
                    const mobileClose =
                        document.getElementById("mobileMenuClose");
                    const sidebar = document.querySelector(".sidebar");

                    const toggleMenu = () => {
                        sidebar.classList.toggle("mobile-open");
                        mobileToggle.textContent = sidebar.classList.contains(
                            "mobile-open",
                        )
                            ? "üì± Hide Menu"
                            : "üì± Show Menu";
                    };

                    mobileToggle.addEventListener("click", toggleMenu);
                    mobileClose.addEventListener("click", toggleMenu);

                    // Prestige button event listener
                    this.prestigeButton.addEventListener("click", () =>
                        this.prestige(),
                    );
                }

                setupTabs() {
                    const tabs = [
                        { button: "upgradesTab", content: "upgradesContent" },
                        { button: "clickTab", content: "clickContent" },
                        { button: "autoTab", content: "autoContent" },
                        {
                            button: "achievementsTab",
                            content: "achievementsContent",
                        },
                        { button: "prestigeTab", content: "prestigeContent" },
                    ];

                    tabs.forEach((tab1) => {
                        document
                            .getElementById(tab1.button)
                            .addEventListener("click", () => {
                                tabs.forEach((tab2) => {
                                    document
                                        .getElementById(tab2.button)
                                        .classList.remove("active");
                                    document
                                        .getElementById(tab2.content)
                                        .classList.remove("active");
                                });
                                document
                                    .getElementById(tab1.button)
                                    .classList.add("active");
                                document
                                    .getElementById(tab1.content)
                                    .classList.add("active");
                            });
                    });
                }

                clickGoose(event) {
                    const clickValue =
                        this.gameState.clickPower *
                        this.gameState.prestigeMultiplier;
                    this.gameState.apples += clickValue;
                    this.gameState.totalApples += clickValue;
                    this.gameState.totalClicks++;

                    const now = Date.now();
                    this.clickTimes.push(now);

                    this.clickTimes = this.clickTimes.filter(
                        (time) => now - time <= 10000,
                    );

                    if (this.clickTimes.length > 1) {
                        const timeSpan = (now - this.clickTimes[0]) / 1000;
                        this.dynamicClicksPerSecond =
                            this.clickTimes.length / Math.max(timeSpan, 1);
                    } else {
                        this.dynamicClicksPerSecond = this.clickTimes.length;
                    }

                    this.createClickEffect(event, clickValue);

                    const goose = document.getElementById("mainGoose");

                    if (!goose.classList.contains("shake")) {
                        goose.classList.add("shake");
                    }

                    if (this.shakeTimeout) {
                        clearTimeout(this.shakeTimeout);
                    }

                    this.shakeTimeout = setTimeout(() => {
                        goose.classList.remove("shake");
                        this.shakeTimeout = null;
                    }, 400);

                    this.checkAchievements();
                    this.updateDisplay();
                    this.saveGame();
                }

                createClickEffect(event, value) {
                    const effect = document.createElement("div");
                    effect.className = "click-effect";
                    effect.textContent = `+${this.formatNumber(value)}`;
                    effect.style.left = event.clientX + "px";
                    effect.style.top = event.clientY + "px";
                    document.body.appendChild(effect);

                    setTimeout(() => {
                        document.body.removeChild(effect);
                    }, 1000);
                }

                buyUpgrade(upgradeId, quantity = 1) {
                    const upgrade = this.upgrades.find(
                        (u) => u.id === upgradeId,
                    );
                    const currentCount =
                        this.gameState.upgrades[upgradeId] || 0;

                    let actualQuantity = quantity;
                    let totalCost = 0;

                    if (quantity === "max") {
                        actualQuantity = this.calculateMaxBuy(
                            upgrade,
                            currentCount,
                        );
                        totalCost = this.calculateBulkCost(
                            upgrade,
                            currentCount,
                            actualQuantity,
                        );
                    } else {
                        actualQuantity = Math.min(
                            quantity,
                            this.calculateMaxBuy(upgrade, currentCount),
                        );
                        totalCost = this.calculateBulkCost(
                            upgrade,
                            currentCount,
                            actualQuantity,
                        );
                    }

                    if (
                        actualQuantity > 0 &&
                        this.gameState.apples >= totalCost
                    ) {
                        this.gameState.apples -= totalCost;
                        this.gameState.upgrades[upgradeId] =
                            currentCount + actualQuantity;

                        if (upgrade.type === "passive") {
                            this.calculateApplesPerSecond();
                        } else if (upgrade.type === "click") {
                            this.calculateClickPower();
                        } else if (upgrade.type === "auto") {
                            this.calculateAutoClicksPerSecond();
                            this.startAutoClicker();
                        }

                        this.checkAchievements();
                        this.updateDisplay();
                        this.saveGame();
                    }
                }

                calculateBulkCost(upgrade, currentCount, quantity) {
                    let totalCost = 0;
                    for (let i = 0; i < quantity; i++) {
                        totalCost += Math.floor(
                            upgrade.baseCost *
                                Math.pow(
                                    upgrade.costMultiplier,
                                    currentCount + i,
                                ),
                        );
                    }
                    return totalCost;
                }

                calculateMaxBuy(upgrade, currentCount) {
                    let count = 0;
                    let totalCost = 0;
                    while (true) {
                        const nextCost = Math.floor(
                            upgrade.baseCost *
                                Math.pow(
                                    upgrade.costMultiplier,
                                    currentCount + count,
                                ),
                        );
                        if (totalCost + nextCost > this.gameState.apples) {
                            break;
                        }
                        totalCost += nextCost;
                        count++;
                        if (count >= 1000) break; // Safety limit
                    }
                    return count;
                }

                calculateApplesPerSecond() {
                    let aps = 0;
                    this.upgrades.forEach((upgrade) => {
                        if (upgrade.type === "passive") {
                            const count =
                                this.gameState.upgrades[upgrade.id] || 0;
                            aps += upgrade.bpsIncrease * count;
                        }
                    });
                    this.gameState.applesPerSecond =
                        aps * (this.gameState.prestigeMultiplier || 1);

                    this.createDecorativeApples();
                }

                calculateAutoClicksPerSecond() {
                    let autoClicks = 0;
                    this.upgrades.forEach((upgrade) => {
                        if (upgrade.type === "auto") {
                            const count =
                                this.gameState.upgrades[upgrade.id] || 0;
                            autoClicks += upgrade.bpsIncrease * count;
                        }
                    });
                    this.gameState.autoClicks =
                        autoClicks * (this.gameState.prestigeMultiplier || 1);
                }

                prestige() {
                    if (this.gameState.apples >= IdleGooseGame.PRESTIGE_COST) {
                        this.gameState.apples = 0;
                        this.gameState.prestigePoints =
                            (this.gameState.prestigePoints || 0) + 1;
                        this.gameState.prestigeMultiplier =
                            1 + this.gameState.prestigePoints * 0.1;

                        this.gameState.clickPower = 1;
                        this.gameState.applesPerSecond = 0;
                        this.gameState.autoClicks = 0;

                        for (const upgradeId in this.gameState.upgrades) {
                            this.gameState.upgrades[upgradeId] = 0;
                        }

                        this.saveGame();
                        this.updateDisplay();
                        console.log(
                            "Prestigious Goose! Prestige Points: " +
                                this.gameState.prestigePoints,
                        );
                        this.showAchievementNotification(
                            "Prestige!",
                            `You gained a Prestige Point! Total: ${this.gameState.prestigePoints}`,
                        );
                    } else {
                        this.showAchievementNotification(
                            "Cannot Prestige",
                            `Need ${this.formatNumber(
                                IdleGooseGame.PRESTIGE_COST,
                            )} apples to prestige.`,
                        );
                    }
                }

                calculateClickPower() {
                    let clickPower = 1;
                    this.upgrades.forEach((upgrade) => {
                        if (upgrade.type === "click") {
                            const count =
                                this.gameState.upgrades[upgrade.id] || 0;
                            clickPower += upgrade.clickIncrease * count;
                        }
                    });
                    this.gameState.clickPower = clickPower;
                }

                calculateAutoClicksPerSecond() {
                    let autoClicks = 0;
                    this.upgrades.forEach((upgrade) => {
                        if (upgrade.type === "auto") {
                            const count =
                                this.gameState.upgrades[upgrade.id] || 0;
                            autoClicks += upgrade.autoClickIncrease * count;
                        }
                    });
                    this.gameState.autoClicksPerSecond = autoClicks;

                    this.createDecorativeApples();
                }

                checkAchievements() {
                    this.achievements.forEach((achievement) => {
                        if (
                            !this.gameState.achievements.has(achievement.id) &&
                            achievement.condition()
                        ) {
                            this.gameState.achievements.add(achievement.id);
                            this.showAchievementNotification(
                                achievement.name,
                                achievement.description,
                            );
                        }
                    });
                }

                showAchievementNotification(title, message) {
                    console.log(`Achievement Unlocked: ${title} - ${message}`);
                    // A simple notification display. You can enhance this with a proper UI notification system.
                    const notification = document.createElement("div");
                    notification.className = "achievement-notification";
                    notification.style.cssText = `
                        position: fixed;
                        bottom: 20px;
                        left: 50%;
                        transform: translateX(-50%);
                        background-color: #4CAF50;
                        color: white;
                        padding: 10px 20px;
                        border-radius: 5px;
                        z-index: 1000;
                        opacity: 0;
                        transition: opacity 0.5s ease-in-out;
                    `;
                    notification.textContent = `${title}: ${message}`;
                    document.body.appendChild(notification);

                    setTimeout(() => {
                        notification.style.opacity = "1";
                    }, 100);

                    setTimeout(() => {
                        notification.style.opacity = "0";
                        notification.addEventListener("transitionend", () =>
                            notification.remove(),
                        );
                    }, 3000);
                }

                createUpgradeElements() {
                    const upgradesContainer =
                        document.getElementById("upgrades");
                    const clickUpgradesContainer =
                        document.getElementById("clickUpgrades");
                    const autoUpgradesContainer =
                        document.getElementById("autoUpgrades");

                    this.upgrades.forEach((upgrade) => {
                        const upgradeElement = document.createElement("div");
                        upgradeElement.className = "upgrade";
                        upgradeElement.innerHTML = `
                            <div class="upgrade-count" id="count-${upgrade.id}">0</div>
                            <div class="upgrade-info">
                                <div class="upgrade-name">${upgrade.name}</div>
                                <div class="upgrade-description">${upgrade.description}</div>
                            </div>
                            <div class="upgrade-buttons">
                                <div class="buy-quantity-row">
                                    <button class="upgrade-button" id="btn-${upgrade.id}-1">1</button>
                                    <button class="upgrade-button" id="btn-${upgrade.id}-10">10</button>
                                    <button class="upgrade-button" id="btn-${upgrade.id}-100">100</button>
                                    <button class="upgrade-button max" id="btn-${upgrade.id}-max">Max</button>
                                </div>
                                <div class="upgrade-cost" id="cost-${upgrade.id}"></div>
                            </div>
                        `;

                        if (upgrade.type === "passive") {
                            upgradesContainer.appendChild(upgradeElement);
                        } else if (upgrade.type === "click") {
                            clickUpgradesContainer.appendChild(upgradeElement);
                        } else if (upgrade.type === "auto") {
                            autoUpgradesContainer.appendChild(upgradeElement);
                        }

                        document
                            .getElementById(`btn-${upgrade.id}-1`)
                            .addEventListener("click", () =>
                                this.buyUpgrade(upgrade.id, 1),
                            );
                        document
                            .getElementById(`btn-${upgrade.id}-10`)
                            .addEventListener("click", () =>
                                this.buyUpgrade(upgrade.id, 10),
                            );
                        document
                            .getElementById(`btn-${upgrade.id}-100`)
                            .addEventListener("click", () =>
                                this.buyUpgrade(upgrade.id, 100),
                            );
                        document
                            .getElementById(`btn-${upgrade.id}-max`)
                            .addEventListener("click", () =>
                                this.buyUpgrade(upgrade.id, "max"),
                            );
                    });
                }

                createAchievementElements() {
                    const achievementsContainer =
                        document.getElementById("achievements");
                    this.achievements.forEach((achievement) => {
                        const achievementElement =
                            document.createElement("div");
                        achievementElement.className = "achievement";
                        achievementElement.id = `achievement-${achievement.id}`;
                        achievementElement.innerHTML = `
                            <strong>${achievement.name}</strong><br>
                            <small>${achievement.description}</small>
                        `;
                        achievementsContainer.appendChild(achievementElement);
                    });
                }

                updateDisplay() {
                    document.getElementById("apples").textContent =
                        this.formatNumber(this.gameState.apples);

                    const totalPerSecond =
                        this.gameState.applesPerSecond +
                        this.dynamicClicksPerSecond *
                            this.gameState.clickPower *
                            (this.gameState.prestigeMultiplier || 1);

                    document.getElementById("applesPerSecond").textContent =
                        this.formatNumber(totalPerSecond, 1);

                    document.getElementById(
                        "applesPerSecondFullNumber",
                    ).textContent = totalPerSecond.toLocaleString(undefined, {
                        minimumFractionDigits: 1,
                        maximumFractionDigits: 1,
                    });

                    if (this.prestigePointsElement) {
                        this.prestigePointsElement.textContent =
                            this.gameState.prestigePoints;
                    }
                    if (this.prestigeCostElement) {
                        this.prestigeCostElement.textContent =
                            this.formatNumber(IdleGooseGame.PRESTIGE_COST);
                    }
                    if (this.prestigeButton) {
                        this.prestigeButton.disabled =
                            this.gameState.apples < IdleGooseGame.PRESTIGE_COST;
                        if (this.prestigeButton.disabled) {
                            this.prestigeButton.classList.add("disabled");
                        } else {
                            this.prestigeButton.classList.remove("disabled");
                        }
                    }

                    document.getElementById("applesFullNumber").textContent =
                        this.gameState.apples.toLocaleString(undefined, {
                            minimumFractionDigits: 0,
                            maximumFractionDigits: 0,
                        });

                    document.getElementById("mobileApples").textContent =
                        this.formatNumber(this.gameState.apples);
                    document.getElementById(
                        "mobileApplesPerSecond",
                    ).textContent = this.formatNumber(totalPerSecond, 1);
                    document.getElementById(
                        "mobileApplesFullNumber",
                    ).textContent = this.gameState.apples.toLocaleString(
                        undefined,
                        {
                            minimumFractionDigits: 0,
                            maximumFractionDigits: 0,
                        },
                    );
                    document.getElementById(
                        "mobileApplesPerSecondFullNumber",
                    ).textContent = totalPerSecond.toLocaleString(undefined, {
                        minimumFractionDigits: 1,
                        maximumFractionDigits: 1,
                    });

                    this.upgrades.forEach((upgrade) => {
                        const count = this.gameState.upgrades[upgrade.id] || 0;
                        const cost = this.calculateBulkCost(upgrade, count, 1);
                        const countElement = document.getElementById(
                            `count-${upgrade.id}`,
                        );
                        const costElement = document.getElementById(
                            `cost-${upgrade.id}`,
                        );

                        if (countElement) {
                            countElement.textContent = this.formatNumber(count);
                        }
                        if (costElement) {
                            costElement.textContent = this.formatNumber(cost);
                        }

                        [1, 10, 100, "max"].forEach((qty) => {
                            const btn = document.getElementById(
                                `btn-${upgrade.id}-${qty}`,
                            );
                            if (btn) {
                                const buyAmount =
                                    qty === "max"
                                        ? this.calculateMaxBuy(upgrade, count)
                                        : qty;
                                const bulkCost = this.calculateBulkCost(
                                    upgrade,
                                    count,
                                    buyAmount,
                                );
                                btn.disabled =
                                    this.gameState.apples < bulkCost ||
                                    buyAmount === 0;

                                if (btn.disabled) {
                                    btn.classList.add("disabled");
                                } else {
                                    btn.classList.remove("disabled");
                                }
                            }
                        });
                    });

                    this.achievements.forEach((achievement) => {
                        const achievementElement = document.getElementById(
                            `achievement-${achievement.id}`,
                        );
                        if (
                            achievementElement &&
                            this.gameState.achievements.has(achievement.id)
                        ) {
                            achievementElement.classList.add("unlocked");
                        } else if (achievementElement) {
                            achievementElement.classList.remove("unlocked");
                        }
                    });
                }

                formatNumber(num, decimalPlaces = 0) {
                    if (num >= 1000000000000) {
                        return (
                            (num / 1000000000000).toFixed(decimalPlaces) + "T"
                        );
                    }
                    if (num >= 1000000000) {
                        return (num / 1000000000).toFixed(decimalPlaces) + "B";
                    }
                    if (num >= 1000000) {
                        return (num / 1000000).toFixed(decimalPlaces) + "M";
                    }
                    if (num >= 1000) {
                        return (num / 1000).toFixed(decimalPlaces) + "K";
                    }
                    return num.toFixed(decimalPlaces);
                }

                startGameLoop() {
                    setInterval(() => {
                        this.gameState.apples += this.gameState.applesPerSecond;
                        this.gameState.totalApples +=
                            this.gameState.applesPerSecond;
                        this.checkAchievements();
                        this.updateDisplay();
                        this.saveGame();
                    }, 1000);
                }

                saveGame() {
                    this.gameState.lastSaveTime = Date.now();
                    const saveData = {
                        ...this.gameState,
                        achievements: Array.from(this.gameState.achievements), // Convert Set to Array for saving
                    };
                    localStorage.setItem(
                        "idleGooseGame",
                        JSON.stringify(saveData),
                    );
                }

                loadGame() {
                    const savedGame = localStorage.getItem("idleGooseGame");
                    if (savedGame) {
                        const loadedState = JSON.parse(savedGame);
                        this.gameState = {
                            ...this.gameState,
                            ...loadedState,
                            achievements: new Set(
                                Array.isArray(loadedState.achievements)
                                    ? loadedState.achievements
                                    : [],
                            ),
                        };
                        if (this.gameState.prestigePoints === undefined) {
                            this.gameState.prestigePoints = 0;
                        }
                        this.gameState.prestigeMultiplier =
                            1 + this.gameState.prestigePoints * 0.1;
                    }
                }

                startAutoClicker() {
                    if (this.autoClickInterval) {
                        clearInterval(this.autoClickInterval);
                    }
                    if (this.gameState.autoClicksPerSecond > 0) {
                        const clicksPerTick = 1;
                        const delay = 1000 / this.gameState.autoClicksPerSecond;
                        this.autoClickInterval = setInterval(() => {
                            for (let i = 0; i < clicksPerTick; i++) {
                                if (this.gameState.autoClicksPerSecond > 0) {
                                    const clickValue =
                                        this.gameState.clickPower *
                                        this.gameState.prestigeMultiplier;
                                    this.gameState.apples += clickValue;
                                    this.gameState.totalApples += clickValue;
                                    this.gameState.totalClicks++;

                                    const goose =
                                        document.getElementById("mainGoose");
                                    const gooseRect =
                                        goose.getBoundingClientRect();
                                    const centerX =
                                        gooseRect.left + gooseRect.width / 2;
                                    const centerY =
                                        gooseRect.top + gooseRect.height / 2;
                                    const randomX =
                                        centerX +
                                        (Math.random() - 0.5) *
                                            gooseRect.width *
                                            0.8;
                                    const randomY =
                                        centerY +
                                        (Math.random() - 0.5) *
                                            gooseRect.height *
                                            0.8;

                                    this.createClickEffect(
                                        { clientX: randomX, clientY: randomY },
                                        clickValue,
                                    );
                                }
                            }
                            this.checkAchievements();
                            this.updateDisplay();
                        }, delay);
                    }
                }

                createAutoClickEffect(position, value) {
                    const effect = document.createElement("div");
                    effect.className = "click-effect auto-click";
                    effect.textContent = `+${this.formatNumber(value)}`;
                    effect.style.left = position.x + "px";
                    effect.style.top = position.y + "px";
                    document.body.appendChild(effect);

                    setTimeout(() => {
                        document.body.removeChild(effect);
                    }, 1000);
                }

                calculateOfflineProgress() {
                    const now = Date.now();
                    const lastSaveTime = this.gameState.lastSaveTime || now;
                    const timeElapsed = (now - lastSaveTime) / 1000;

                    if (timeElapsed > 5) {
                        const applesGained =
                            this.gameState.applesPerSecond * timeElapsed;
                        this.gameState.apples += applesGained;
                        this.gameState.totalApples += applesGained;
                        console.log(
                            `Offline progress: Gained ${this.formatNumber(
                                applesGained,
                            )} apples over ${timeElapsed.toFixed(0)} seconds.`,
                        );
                        this.showOfflineProgress(applesGained, timeElapsed);
                    }
                }

                showOfflineProgress(applesGained, timeElapsed) {
                    const overlay = document.createElement("div");
                    overlay.style.position = "fixed";
                    overlay.style.top = "0";
                    overlay.style.left = "0";
                    overlay.style.width = "100%";
                    overlay.style.height = "100%";
                    overlay.style.backgroundColor = "rgba(0, 0, 0, 0.7)";
                    overlay.style.color = "white";
                    overlay.style.display = "flex";
                    overlay.style.flexDirection = "column";
                    overlay.style.justifyContent = "center";
                    overlay.style.alignItems = "center";
                    overlay.style.zIndex = "9999";
                    overlay.style.fontSize = "2em";
                    overlay.style.textAlign = "center";
                    overlay.innerHTML = `
            <h2>Welcome back, Goose!</h2>
            <p>While you were away for ${timeElapsed.toFixed(0)} seconds:</p>
            <p>You gathered üçé ${this.formatNumber(applesGained)} apples!</p>
            <button id="closeOfflineProgress" style="margin-top: 20px; padding: 10px 20px; font-size: 0.8em; cursor: pointer;">Awesome!</button>
        `;
                    document.body.appendChild(overlay);

                    document
                        .getElementById("closeOfflineProgress")
                        .addEventListener("click", () => {
                            document.body.removeChild(overlay);
                        });
                }

                createDecorativeApples() {
                    const decorativeApplesContainer =
                        document.getElementById("decorativeApples");
                    if (!decorativeApplesContainer) return;

                    decorativeApplesContainer.innerHTML = "";

                    const maxApples = 50;
                    const appleCount = Math.min(
                        maxApples,
                        Math.floor(this.gameState.applesPerSecond / 10) + 5,
                    );

                    for (let i = 0; i < appleCount; i++) {
                        const apple = document.createElement("div");
                        apple.className = "apple";
                        apple.textContent = "üçé";
                        apple.style.left = `${Math.random() * 90 + 5}%`;
                        apple.style.animationDuration = `${
                            Math.random() * 10 + 5
                        }s`;
                        apple.style.animationDelay = `${Math.random() * -10}s`;
                        decorativeApplesContainer.appendChild(apple);
                    }
                }
            }

            document.addEventListener("DOMContentLoaded", () => {
                const game = new IdleGooseGame();
            });
        </script>
    </body>
</html>
